<!DOCTYPE html>
<html lang="zxx">


<head>

    <!-- Meta -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">

    <!-- Title -->
    <title>Search Friends</title>

    <!-- Favicon -->
    <link href="../images/favicon.ico" rel="icon" type="image/x-icon" />

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i%7CLato:100,100i,300,300i,400,400i,700,700i,900,900i"
        rel="stylesheet" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/fontawesome.min.css"
        integrity="sha384-wESLQ85D6gbsF459vf1CiZ2+rr+CsxRY0RpiF1tLlQpDnAgg6rwdsUF1+Ics2bni" crossorigin="anonymous">
    <link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />

    <script src="https://kit.fontawesome.com/ad214375d6.js" crossorigin="anonymous"></script>
    <!-- Mobile Menu -->
    <link href="../css/mmenu.css" rel="stylesheet" type="text/css" />
    <link href="../css/mmenu.positioning.css" rel="stylesheet" type="text/css" />

    <!-- Responsive Table -->
    <link rel="stylesheet" type="text/css" href="../css/responsivetable.css" />

    <!-- Stylesheet -->
    <link href="../style.css" rel="stylesheet" type="text/css" />
</head>

<body>


    <header id="header-v1" class="navbar-wrapper inner-navbar-wrapper">
        <div class="container">
            <div class="row">
                <nav class="navbar navbar-default">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="navbar-header">
                                <div class="navbar-brand">
                                    <h1>
                                        <a href="iiti.ac.in">
                                            <img style="width: 150px; height: 60px;"
                                                src="https://admin.google.com/u/1/ac/images/logo.gif?uid=118001285387843873635&service=google_gsuite"
                                                alt="LIBRARY" />
                                        </a>
                                    </h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-9">
                            <!-- Header Topbar -->
                            <div class="header-topbar hidden-sm hidden-xs">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="topbar-info">
                                            <a href="tel:0731-6603424"><i class="fa fa-phone"></i>0731-6603424</a>
                                            <span>/</span>
                                            <a href="mailto:library@iiti.ac.in"><i
                                                    class="fa fa-envelope"></i>library@iiti.ac.in</a>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="topbar-links">
                                            <a href="<%=path%>auth/logout"><i class="fa fa-lock"></i>Log Out</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="navbar-collapse hidden-sm hidden-xs">
                                <ul class="nav navbar-nav">
                                    <li class="dropdown">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="<%=path%>user/home">Home</a>
                                    </li>
                                    <li class="dropdown">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="<%=path%>user/books">Books</a>
                                    </li>
                                    <li class="dropdown">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="#">Pay Fines</a>
                                    </li>
                                    <li class="dropdown active">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="<%=path%>user/friends">Find Friends</a>
                                    </li>
                                    <li class="dropdown">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="<%=path%>aboutus">About Us</a>
                                    </li>
                                    <li class="dropdown">
                                        <a data-toggle="dropdown" class="dropdown-toggle disabled" href="<%=path%>contactus">Contact
                                            Us</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="mobile-menu hidden-lg hidden-md">
                        <a href="#mobile-menu"><i class="fa fa-navicon"></i></a>
                        <div id="mobile-menu">
                            <ul>
                                <li class="mobile-title">
                                    <h4>Navigation</h4>
                                    <a href="#" class="close"></a>
                                </li>
                                <li>
                                    <a href="<%=path%>user/home">Home</a>
                                </li>
                                <li>
                                    <a href="<%=path%>user/books">Books</a>
                                </li>
                                <li>
                                    <a href="#">Pay Fines</a>
                                </li>
                                <li>
                                    <a href="<%=path%>user/friends">Find Friends</a>
                                </li>
                                <li>
                                    <a href="<%=path%>aboutus">About Us</a>
                                </li>
                                <li>
                                    <a href="<%=path%>contactus">Contact Us</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- End: Header Section -->

    <!-- Start: Page Banner -->
    <section class="page-banner services-banner">
        <div class="container">
            <div class="banner-header">
                <h2> Search Friends </h2>
                <span class="underline center"></span>
                <p class="lead">Good friends, good books, and a sleepy conscience: this is the ideal life.</p>
            </div>
            <div class="breadcrumb">
                <ul>
                    <li><a href="<%=path%>user/home">Home</a></li>
                    <li> Find Friends </li>
                </ul>
            </div>
        </div>
    </section>
    <!-- End: Page Banner -->

    <!-- Start: Products Section -->
    <div id="content" class="site-content">
        <div id="primary" class="content-area">
            <main id="main" class="site-main">
                <div class="booksmedia-detail-main">
                    <div class="container">
                        <div class="row">
                            <!-- Start: Search Section -->
                            <section class="search-filters">
                                <div class="container">
                                    <div class="filter-box">
                                        <h3>Whom are you looking for?</h3>
                                        <form class="searchform">
                                            <div class="col-md-4 col-sm-6">
                                                <div class="form-group">
                                                    <label class="sr-only" for="keywords"> Search by Name</label>
                                                    <input class="form-control" placeholder="Search"
                                                        id="keywords" name="keywords" type="text">
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-2 col-sm-6">
                                                <div class="form-group">
                                                    <input class="form-control searchbutton" type="submit"
                                                        value="Search">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </section>
                            <!-- End: Search Section -->






                            <div class="col-md-12">
                                <div class="page type-page status-publish hentry">
                                    <div class="entry-content">
                                        <div class="woocommerce table-tabs" id="responsiveTabs">

                                            <div class="tab-content">
                                                <!-- <form method="post" action=""> -->
                                                    <table class="table table-bordered shop_table cart">
                                                        <thead>
                                                            <tr>
                                                                <th class="product-name">&nbsp;</th>
                                                                <th class="product-name">Name</th>
                                                                <th class="product-quantity">UserID</th>
                                                                <th class="product-quantity">Address</th>
                                                                <th class="product-quantity">Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="friendlist">


                                                        </tbody>
                                                    </table>
                                                <!-- </form> -->

                                            </div>
                                        </div>
                                    </div><!-- .entry-content -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <!-- End: Cart Section -->



    <!-- Start: Social Network -->
    <section class="social-network section-padding">
        <div class="container" style="margin: auto; ">
            <div class="center-content">
                <h2 class="section-title">Follow Us</h2>
                <span class="underline center"></span><br><br>
            </div>
            <ul style="margin: auto; padding-left: 250px;">
                <li style="width: 100px; margin: 10px 10px;">
                    <a class="facebook" href="#" target="_blank" style=" height: 100px;">
                        <span>
                            <i class="fa fa-facebook-f" style="font-size: 50px;"></i>
                        </span>
                    </a>
                </li>
                <li style="width: 100px; margin: 10px 10px;">
                    <a class="twitter" href="#" target="_blank" style=" height: 100px;">
                        <span>
                            <i class="fa fa-twitter" style="font-size: 50px;"></i>
                        </span>
                    </a>
                </li>
                <li style="width: 100px; margin: 10px 10px;">
                    <a class="google" href="#" target="_blank"style=" height: 100px;">
                        <span>
                            <i class="fa fa-google-plus" style="font-size: 50px;"></i>
                        </span>
                    </a>
                </li>
                <li style="width: 100px; margin: 10px 10px;">
                    <a class="linkedin" href="#" target="_blank" style=" height: 100px;">
                        <span>
                            <i class="fa fa-linkedin" style="font-size: 50px;"></i>
                        </span>
                    </a>
                </li>
                <li style="width: 100px; margin: 10px 10px;">
                    <a class="youtube" href="#" target="_blank" style=" height: 100px;">
                        <span>
                            <i class="fa fa-youtube" style="font-size: 50px;"></i>
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </section>
    <!-- End: Social Network -->


    <!-- Start: Footer -->
    <footer class="site-footer">
        <div class="container">
            <div id="footer-widgets">
                <div class="row">
                    <div class="col-md-4 col-sm-6 widget-container">
                        <div id="text-2" class="widget widget_text">
                            <h3 class="footer-widget-title">About Library</h3>
                            <span class="underline left"></span>
                            <div class="textwidget">
                                “Sometimes, you read a book and it fills you with this weird evangelical zeal, and you
                                become convinced that the shattered world will never be put back together unless and
                                until all living humans read the book.”
                            </div>
                            <address>
                                <div class="info">
                                    <i class="fa fa-location-arrow"></i>
                                    <span> IIT Indore, Khandwa Road, SIMROL, <br> District : Indore – 453552, Madhya
                                        Pradesh, India</span>
                                </div>
                                <div class="info">
                                    <i class="fa fa-envelope"></i>
                                    <span><a href="mailto:library@iiti.ac.in">library@iiti.ac.in</a></span>
                                </div>
                                <div class="info">
                                    <i class="fa fa-phone"></i>
                                    <span><a href="tel:0731-6603424">0731-6603424</a></span>
                                </div>
                            </address>
                        </div>
                    </div>

                    <div class="col-md-2 col-sm-6 widget-container">
                        <div id="nav_menu-2" class="widget widget_nav_menu">
                            <h3 class="footer-widget-title">Quick Links</h3>
                            <span class="underline left"></span>
                            <div class="menu-quick-links-container">
                                <ul id="menu-quick-links" class="menu">
                                    <li>
                                        <a href="<%=path%>user/home">Home</a>
                                    </li>
                                    <li>
                                        <a href="<%=path%>user/books">Books</a>
                                    </li>
                                    <li>
                                        <a href="#">Pay Fines</a>
                                    </li>
                                    <li>
                                        <a href="<%=path%>user/friends">Find Friends</a>
                                    </li>
                                    <li>
                                        <a href="<%=path%>aboutus">About Us</a>
                                    </li>
                                    <li>
                                        <a href="<%=path%>contactus">Contact Us</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix hidden-lg hidden-md hidden-xs tablet-margin-bottom"></div>

                </div>
            </div>
        </div>

    </footer>
    <!-- End: Footer -->

    <!-- jQuery Latest Version 1.x -->
    <script type="text/javascript" src="../js/jquery-1.12.4.min.js"></script>

    <!-- jQuery UI -->
    <script type="text/javascript" src="../js/jquery-ui.min.js"></script>

    <!-- jQuery Easing -->
    <script type="text/javascript" src="../js/jquery.easing.1.3.js"></script>

    <!-- Bootstrap -->
    <script type="text/javascript" src="../js/bootstrap.min.js"></script>

    <!-- Mobile Menu -->
    <script type="text/javascript" src="../js/mmenu.min.js"></script>

    <!-- Harvey - State manager for media queries -->
    <script type="text/javascript" src="../js/harvey.min.js"></script>

    <!-- Waypoints - Load Elements on View -->
    <script type="text/javascript" src="../js/waypoints.min.js"></script>

    <!-- Facts Counter -->
    <script type="text/javascript" src="../js/facts.counter.min.js"></script>

    <!-- MixItUp - Category Filter -->
    <script type="text/javascript" src="../js/mixitup.min.js"></script>

    <!-- Owl Carousel -->
    <script type="text/javascript" src="../js/owl.carousel.min.js"></script>

    <!-- Accordion -->
    <script type="text/javascript" src="../js/accordion.min.js"></script>

    <!-- Responsive Tabs -->
    <script type="text/javascript" src="../js/responsive.tabs.min.js"></script>

    <!-- Responsive Table -->
    <script type="text/javascript" src="../js/responsive.table.min.js"></script>

    <!-- Masonry -->
    <script type="text/javascript" src="../js/masonry.min.js"></script>

    <!-- Carousel Swipe -->
    <script type="text/javascript" src="../js/carousel.swipe.min.js"></script>

    <!-- bxSlider -->
    <script type="text/javascript" src="../js/bxslider.min.js"></script>

    <!-- Custom Scripts -->
    <script type="text/javascript" src="../js/main.js"></script>

    <script>
        let path = window.location.origin;
        $(document).ready(() => {
            $('.searchform').submit(e => {
                e.preventDefault();
            })
            $('.searchbutton').click(() => {
                console.log('clicked');
                let sub = $('#keywords').val();
                $.ajax({
                    type: 'POST',
                    url: path + "/user/findfriends",
                    data: {
                        sub
                    },
                    success: (result) => {
                        console.log(result);
                        let p = "";
                        for (let i = 0; i < result.length; i++) {
                            let ficon = "";
                            if (result[i].friend == 0) {
                                ficon = `<i title= 'send request' style="cursor: pointer;font-size: x-large; color: #6f6fe8;" class='${result[i].userID} fas fa-user-plus addfriend'></i>`;
                            } else if (result[i].friend == 1) {
                                ficon = `<i title='unfriend' style="font-size: x-large;cursor: pointer; color: #8ec68e" class='${result[i].userID} fas fa-user-check unfriend'></i>`;
                            } else if (result[i].friend == 2) {
                                ficon = `<i title='request sent' style="font-size: x-large; color: #c8c8c8; cursor: pointer;" class='${result[i].userID} fas fa-user-check requested'></i>`;
                            } else {
                                ficon = `<i title='accept request' style="cursor: pointer; font-size: x-large; color: #6f6fe8" class='${result[i].userID} fas fa-check respond'></i>`;

                            }
                            p += `<tr class="cart_item">
                                <td> 1. </td>
                                <td data-title="Product" class="product-name">
                                                                            <span class="product-thumbnail">
                                                                                <strong>    ${result[i].name}   </strong>
                                                                                </span>
                                                                                </td>
                                                                                <td data-title="Product" class="product-name">
                                                                                    <span class="product-thumbnail">
                                                                                        <strong>    ${result[i].userID}   </strong>
                                                                                        </span>
                                                                                        </td>
                                                                                        <td data-title="Product" class="product-name">
                                                                                            <span class="product-thumbnail">
                                                                                                <strong>    ${result[i].address}   </strong>
                                                                                                </span>
                                                                                                </td>
                                                                                                <td data-title="action" class="product-action">
                                                                                                    ${ficon}
                                                                            </td>
                                                                            </tr>`;
                        }
                        $('#friendlist').html(p)
                    }
                })
            })
            $(document).on('click', '.addfriend', (e) => {
                let friendid = ($(e.target).attr('class').split(' ')[0]);
                $.ajax({
                    type: 'POST',
                    url: path + '/user/requestfriend',
                    data: {
                        friendid
                    }, success: (response) => {
                        $(e.target).removeClass('addfriend');
                        $(e.target).addClass('requested');
                        $(e.target).css('color', '#c8c8c8');
                        $(e.target).attr('title', 'request sent');
                        console.log(response.msg);
                    }
                })
            })
            $(document).on('click', '.unfriend', e => {
                if (confirm('Are you sure you want to unfriend?')) {
                    let friendid = ($(e.target).attr('class').split(' ')[0]);
                    $.ajax({
                        type: 'POST',
                        url: path + '/user/unfriend',
                        data: {
                            friendid
                        }, success: (response) => {
                            $(e.target).removeClass('fa-user-check');
                            $(e.target).removeClass('unfriend');
                            $(e.target).addClass('fa-user-plus');
                            $(e.target).addClass('addfriend');
                            $(e.target).css('color','#6f6fe8');
                            $(e.target).attr('title', 'send request');
                            console.log(response.msg);
                        }
                    })
                }
            })
            $(document).on('click','.respond', e=>{
                let friendid = ($(e.target).attr('class').split(' ')[0]);
                $.ajax({
                    type: 'POST',
                    url: path + '/user/approvefriend',
                    data: {
                        friendid
                    }, success: (response) => {
                        $(e.target).removeClass('fa-check');
                        $(e.target).removeClass('respond');
                        $(e.target).addClass('fa-user-check');
                        $(e.target).addClass('unfriend');
                        $(e.target).css('color','#8ec68e');
                        $(e.target).attr('title', 'unfriend');
                        console.log('approved');
                    }
                })

            })
        })
    </script>

</body>